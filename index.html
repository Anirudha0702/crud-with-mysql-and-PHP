<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="./resets.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
</head>
<body>
    <div class="main_wrapper">
        <h3 class="title">COLLEGE DATABASE</h3>
        <div class="wrapper" >
            <nav class="navbar">
                <ol>
                    <li class="items" onclick="createTable()">Create Table</li>
                    <li class="items">
                        <select onchange="updateURLS(this.value)">
                            <?php
                                include "displayTableNames.php"
                            ?>
                        </select>
                        
                        
                    </li>
                    <li class="items"><a href="#" class="delete link">Delete Table</a></li>
                    <li class="items"><a href="#" class="insert link">Insert Row</a></li>
                    <li class="items"><a href="#" class="update link">UpdateTable</a></li>
                    <li class="items"><a href="#" class="create link">Show Table</a></li>
                </ol>
            </nav>
            <div class="content" >
                <?php
                if(isset($_GET['message']) && $_GET['message'] == 'success'){
                    echo "<p style='color:green'>".$_GET['msg']."</p>";
                }
                elseif(isset($_GET['message']) && $_GET['message'] == 'failed'){
                    echo "<p style='color:red'> error while executing the query ".$_GET['err']."</p>";
                }

                elseif(isset($_GET['table_name']) && $_GET['table_name'] != '' &&isset($_GET['show']) && $_GET['show'] == 'true'){
                    include "showTable.php";
                }
                elseif(isset($_GET['table_name']) && $_GET['table_name'] != '' &&isset($_GET['delete']) && $_GET['delete'] == 'true'){
                    include "deleteTable.php";
                }
                elseif(isset($_GET['table_name']) && $_GET['table_name'] != '' &&isset($_GET['insert']) && $_GET['insert'] == 'true'){
                    include "getColumns.php";
                }
                elseif(isset($_GET['table_name']) && $_GET['table_name'] != '' &&isset($_GET['update']) && $_GET['update'] == 'true'){
                    include "update.php";
                }
                ?>
                
            </div>
        </div>
    </div>
</body>
<script>
    const content = document.querySelector('.content');
    const create_Link = document.querySelector('.create');
    const delete_Link = document.querySelector('.delete');
    const insert_Link = document.querySelector('.insert');
    const update_Link = document.querySelector('.update');
    const select = document.querySelector('select');
    const baseURL = window.location.protocol + "//" + window.location.host + window.location.pathname;
    delete_Link.href = `${baseURL}?table_name=${select.value}&delete=true`;
    create_Link.href = `${baseURL}?table_name=${select.value}&show=true`;
    insert_Link.href = `${baseURL}?table_name=${select.value}&insert=true`;
    update_Link.href = `${baseURL}?table_name=${select.value}&update=true`;

    function updateURLS (value){
            console.log(value);
            create_Link.href = `${baseURL}?table_name=${value}&show=true`;
            delete_Link.href = `${baseURL}?table_name=${value}&delete=true`;
            insert_Link.href = `${baseURL}?table_name=${value}&insert=true`;
            update_Link.href = `${baseURL}?table_name=${value}&update=true`;
            console.log(insert_Link.href)
    }

    function createTable(){
        content.innerHTML = `
        <form action="createTable.php" method="POST">
            <label for="table_name">Table Name</label>
            <input type="text" name="table_name" id="table_name" placeholder="Table Name">
            <label for="name_of_columns">Name of Columns</label>
            <input type="text" name="name_of_columns" id="no_of_columns" placeholder="Name of Columns">
            <p>Eg: id int(11) not null auto_increment primary key; name text(5);</p>
            <button type="submit">Create Table</button>
        </form>
        `;
    }
</script>
</html>